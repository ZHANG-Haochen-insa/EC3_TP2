# TP VHDL Digicode 实验说明

根据您提供的PDF文件和VHDL代码，这节课的主要任务是使用VHDL语言设计和实现一个数字密码锁（Digicode）。

整个实验分为两个主要部分：

### **第一部分：使用默认密码开门**

**目标：**
实现一个状态机，当按顺序输入正确的默认密码后，点亮一个LED灯来模拟“开门”动作。

**核心任务：**

1.  **理解提供的文件：**
    *   `TP VHDL Digicode 2025.pdf`：实验指导书，包含了项目的全部要求。
    *   `code_entier_memoir.vhd`：这是一个内存模块（实体名为 `memoire`）。它的作用是存储4位密码。在复位（Reset）时，它会被初始化为默认密码序列：
        *   `0001` (对应 BTND)
        *   `0010` (对应 BTNR)
        *   `0100` (对应 BTNU)
        *   `1000` (对应 BTNL)
    *   `machine_moore.vhd`：这是一个摩尔（Moore）状态机的模板。你需要在这个文件中编写数字密码锁的核心逻辑。

2.  **编写状态机 (`machine_moore.vhd`)**
    *   你需要根据模板，设计并实现一个状态机。
    *   这个状态机需要能够按顺序（地址00, 01, 10, 11）读取 `memoire` 中的密码。
    *   它需要将读取到的密码与用户通过按钮（BTND, BTNR, BTNU, BTNL）输入的值进行比较。
    *   状态机还需要处理按钮“按下并释放”的检测，以确保每个按钮只被记作一次输入。
    *   当连续四次输入都正确后，状态机需要输出一个信号（例如 `ouverture_porte`）来“打开门”。

3.  **创建顶层文件（Top-level file）**
    *   你需要创建一个新的VHDL文件作为项目的主文件。
    *   在这个文件中，你需要将 `memoire` 模块、你编写的 `machine_moore` 状态机模块以及一个时钟分频器（`division_horloge`，需要自己实现或提供）连接在一起。

4.  **仿真与实现**
    *   对状态机和顶层文件进行仿真，确保逻辑正确。
    *   分配FPGA开发板（Nexys A7）的引脚（I/O）。
    *   将最终生成的文件烧录到FPGA中进行验证。

### **第二部分：实现密码修改功能**

**目标：**
在第一部分的基础上，增加修改密码的功能。

**核心任务：**

1.  **修改状态机 (`machine_moore.vhd`)**
    *   为状态机增加“密码修改模式”。
    *   这个模式只能在成功输入当前密码后，通过一个开关（`MODIF_CODE`）激活。
    *   进入修改模式后，状态机需要能够接收新的4位密码输入，并将其写入内存。

2.  **修改内存模块 (`code_entier_memoir.vhd`)**
    *   当前的内存模块是只读的。你需要给它增加一个写使能（`wen` - write enable）端口和一个数据输入端口。
    *   当写使能信号有效时，内存模块需要能将输入的新密码数据写入到指定的地址。

3.  **修改顶层文件与仿真**
    *   更新顶层文件，将新的信号（如 `MODIF_CODE` 开关、`wen` 等）连接起来。
    *   对修改后的设计进行仿真，验证密码修改功能的正确性。
    *   更新引脚分配，并重新烧录到FPGA中进行最终验证。

**总结来说，你需要完成以下步骤：**
1.  **补完 `machine_moore.vhd`** 以实现密码验证逻辑。
2.  **创建顶层文件** 整合所有模块。
3.  （在第二部分）**修改 `machine_moore.vhd` 和 `code_entier_memoir.vhd`** 以支持密码更改。
4.  进行 **仿真** 和 **板级验证**。
